import{g,c as l,q as i,a as c,o as r,s as v,M as h}from"./form-CTbhfyRB.js";let a={currentRecord:null,modals:null,forms:null,routes:null};function P(){console.log("[PrenatalRecords] Initializing..."),a.routes=g(),_(),y(),R(),console.log("[PrenatalRecords] Initialization complete")}function _(){a.modals=new h,a.modals.register("edit","#edit-prenatal-modal"),l("prenatalRecords","complete")&&a.modals.register("complete","#completePregnancyModal"),window.openViewPrenatalModal=e=>m(e),window.closeViewPrenatalModal=()=>a.modals.close("view"),window.openEditPrenatalModal=e=>f(e),window.closeEditPrenatalModal=()=>a.modals.close("edit"),window.openCompletePregnancyModal=(e,t)=>w(e,t),window.closeCompletePregnancyModal=()=>a.modals.close("complete")}function y(){a.forms={};const e=i("#edit-prenatal-form");e&&(a.forms.edit=c(e,{validation:{last_menstrual_period:{required:!0,date:!0,notFuture:!0},blood_pressure:{required:!1},weight:{numeric:!0},height:{numeric:!0}},successMessage:"Prenatal record updated successfully!",onSuccess:()=>{a.modals.close("edit"),window.location.reload()}}));const t=i("#completePregnancyForm");t&&l("prenatalRecords","complete")&&(a.forms.complete=c(t,{successMessage:"Pregnancy completed successfully!",onSuccess:()=>{a.modals.close("complete"),window.location.reload()}}))}function R(){const e=i("table tbody");e&&(r(e,"click",'.btn-view-prenatal, [onclick*="openViewPrenatalModal"]',function(t){if(this.dataset.record){t.preventDefault();const n=JSON.parse(this.dataset.record);m(n)}}),l("prenatalRecords","edit")&&r(e,"click",'.btn-edit-prenatal, [onclick*="openEditPrenatalModal"]',function(t){if(this.dataset.record){t.preventDefault();const n=JSON.parse(this.dataset.record);f(n)}}),l("prenatalRecords","complete")&&r(e,"click",".btn-complete-pregnancy",function(t){t.preventDefault();const n=this.dataset.id,o=this.dataset.name;w(n,o)}))}function m(e){if(!e){console.error("[PrenatalRecords] No record data provided");return}a.currentRecord=e;const t=(n,o)=>{const s=i(`#${n}`);s&&(s.textContent=o||"N/A")};t("viewPatientName",e.patient?.name),t("viewPatientId",e.patient?.formatted_patient_id),t("viewPatientAge",e.patient?.age?`${e.patient.age} years`:null),t("viewGestationalAge",e.gestational_age),t("viewTrimester",M(e.trimester)),t("viewLMP",e.last_menstrual_period),t("viewEDD",e.expected_due_date),t("viewGravida",e.gravida?`G${e.gravida}`:null),t("viewPara",e.para!==null?`P${e.para}`:null),t("viewStatus",e.status_text||e.status),t("viewBloodPressure",e.blood_pressure),t("viewWeight",e.weight?`${e.weight} kg`:null),t("viewHeight",e.height?`${e.height} cm`:null),t("viewMedicalHistory",e.medical_history),t("viewNotes",e.notes),t("viewLastVisit",e.last_visit),t("viewNextAppointment",e.next_appointment),a.modals.open("view")}function f(e){if(!e){console.error("[PrenatalRecords] No record data provided");return}a.currentRecord=e;const t=(s,d)=>{const p=i(`#${s}`);p&&(p.textContent=d||"N/A")};t("edit-patient-name-display",e.patient?.name),t("edit-patient-id-display",e.patient?.formatted_patient_id||e.patient?.patient_id),t("edit-patient-age-display",e.patient?.age?`${e.patient.age} years`:null);const n=i("#edit-patient-id-hidden");n&&(n.value=e.patient_id||e.patient?.id||"");const o=i("#edit-prenatal-form");if(o&&a.forms.edit){a.forms.edit.setData({last_menstrual_period:u(e.last_menstrual_period),gravida:e.gravida||"",para:e.para||"",blood_pressure:e.blood_pressure||"",weight:e.weight||"",height:e.height||"",medical_history:e.medical_history||"",notes:e.notes||""});const s=i("#edit-status");s&&e.status&&(s.value=e.status);const d=i("#edit-due-date");d&&e.expected_due_date&&(d.value=u(e.expected_due_date)),a.routes.prenatalRecords&&e.id&&(o.action=a.routes.prenatalRecords.update(e.id))}a.modals.open("edit")}function w(e,t){if(!l("prenatalRecords","complete")){v("You do not have permission to complete pregnancies");return}const n=i("#completePatientName");n&&(n.textContent=t||"Unknown Patient");const o=i("#completePregnancyForm");o&&a.routes.prenatalRecords&&(o.action=a.routes.prenatalRecords.complete(e)),a.modals.open("complete")}function M(e){if(!e)return"N/A";const t=e==1?"st":e==2?"nd":"rd";return`${e}${t} Trimester`}function u(e){if(!e)return"";try{return new Date(e).toISOString().split("T")[0]}catch{return""}}document.addEventListener("DOMContentLoaded",P);

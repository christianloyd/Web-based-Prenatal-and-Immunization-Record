const w={confirmButtonColor:"#D4A373",cancelButtonColor:"#6B7280"};function b(e,t=null){return Swal.fire({icon:"success",title:"Success!",text:e,confirmButtonColor:w.confirmButtonColor,confirmButtonText:"Great!",timer:3e3,timerProgressBar:!0}).then(i=>{t&&typeof t=="function"&&t()})}function p(e,t=null){let i=e;return t&&Array.isArray(t)&&t.length>0&&(i+='<br><br><ul class="text-left list-disc list-inside text-sm">',t.forEach(r=>{i+=`<li>${r}</li>`}),i+="</ul>"),Swal.fire({icon:"error",title:"Error!",html:i,confirmButtonColor:w.confirmButtonColor,confirmButtonText:"OK"})}function _(e,t,i,r=null){return Swal.fire({icon:"warning",title:e,text:t,showCancelButton:!0,confirmButtonColor:w.confirmButtonColor,cancelButtonColor:w.cancelButtonColor,confirmButtonText:"Yes, proceed",cancelButtonText:"Cancel"}).then(n=>{n.isConfirmed&&typeof i=="function"?i():n.isDismissed&&r&&typeof r=="function"&&r()})}function D(e,t){return Swal.fire({icon:"warning",title:"Are you sure?",html:`You are about to delete <strong>${e}</strong>.<br>This action cannot be undone!`,showCancelButton:!0,confirmButtonColor:"#DC2626",cancelButtonColor:w.cancelButtonColor,confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel",reverseButtons:!0}).then(i=>{i.isConfirmed&&typeof t=="function"&&t()})}function j(e="Processing..."){Swal.fire({title:e,html:"Please wait...",allowOutsideClick:!1,allowEscapeKey:!1,didOpen:()=>{Swal.showLoading()}})}function V(){Swal.close()}function I(e,t,i,r="Submitting..."){const n=new FormData(e),o=e.querySelector('[type="submit"]'),a=o?o.innerHTML:"";return o&&(o.disabled=!0,o.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>'+r),fetch(e.action,{method:e.method||"POST",body:n,headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},credentials:"same-origin"}).then(l=>l.json()).then(l=>{if(o&&(o.disabled=!1,o.innerHTML=a),l.success)b(l.message||t,i);else{const k=l.errors?Object.values(l.errors).flat():null;p(l.message||"An error occurred",k)}}).catch(l=>{o&&(o.disabled=!1,o.innerHTML=a),console.error("[SweetAlert] AJAX Error:",l),p("An unexpected error occurred. Please try again.")})}function W(){const e=document.querySelector("[data-flash-success]"),t=document.querySelector("[data-flash-error]");if(e){const i=e.getAttribute("data-flash-success");i&&b(i)}if(t){const i=t.getAttribute("data-flash-error");i&&p(i)}}document.addEventListener("DOMContentLoaded",W);typeof window<"u"&&(window.showSuccess=b,window.showError=p,window.showConfirmation=_,window.showDeleteConfirmation=D,window.showLoading=j,window.closeAlert=V,window.handleAjaxSubmit=I);function H(e){if(!e||typeof e!="string")return!1;const t=e.replace(/[\s-]/g,"");return[/^09\d{9}$/,/^\+639\d{9}$/,/^639\d{9}$/].some(r=>r.test(t))}function Y(e){return!e||typeof e!="string"?!1:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function A(e){return e==null?!1:typeof e=="string"?e.trim().length>0:Array.isArray(e)?e.length>0:!0}function J(e,t){return!e||typeof e!="string"?!1:e.length>=t}function X(e,t){return!e||typeof e!="string"?!1:e.length<=t}function x(e){return!isNaN(parseFloat(e))&&isFinite(e)}function E(e){if(!e||typeof e!="string"||!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;const i=new Date(e);return i instanceof Date&&!isNaN(i.getTime())}function U(e){if(!E(e))return!1;const t=new Date(e),i=new Date;return i.setHours(0,0,0,0),t<=i}function K(e){if(!E(e))return!1;const t=new Date(e),i=new Date;return i.setHours(0,0,0,0),t>=i}function d(e,t){if(!e)return;e.classList.add("border-red-500","focus:border-red-500","focus:ring-red-500"),e.classList.remove("border-gray-300"),B(e);const i=document.createElement("div");i.className="validation-error text-red-500 text-sm mt-1",i.textContent=t,i.setAttribute("data-validation-error","true"),e.parentElement.appendChild(i)}function B(e){if(!e)return;e.classList.remove("border-red-500","focus:border-red-500","focus:ring-red-500"),e.classList.add("border-gray-300");const t=e.parentElement.querySelector('[data-validation-error="true"]');t&&t.remove()}function N(e){if(!e)return;e.querySelectorAll("input, select, textarea").forEach(r=>B(r)),e.querySelectorAll('[data-validation-error="true"]').forEach(r=>r.remove())}function G(e,t){N(e);let i=!0;for(const[r,n]of Object.entries(t)){const o=e.querySelector(`[name="${r}"]`);if(!o)continue;const a=o.value;if(n.required&&!A(a)){d(o,`${r} is required`),i=!1;continue}if(!(!A(a)&&!n.required)){if(n.minLength&&!J(a,n.minLength)){d(o,`${r} must be at least ${n.minLength} characters`),i=!1;continue}if(n.maxLength&&!X(a,n.maxLength)){d(o,`${r} must not exceed ${n.maxLength} characters`),i=!1;continue}if(n.email&&!Y(a)){d(o,"Please enter a valid email address"),i=!1;continue}if(n.phone&&!H(a)){d(o,"Please enter a valid Philippine phone number"),i=!1;continue}if(n.numeric&&!x(a)){d(o,`${r} must be a number`),i=!1;continue}if(n.min!==void 0&&x(a)&&parseFloat(a)<n.min){d(o,`${r} must be at least ${n.min}`),i=!1;continue}if(n.max!==void 0&&x(a)&&parseFloat(a)>n.max){d(o,`${r} cannot exceed ${n.max}`),i=!1;continue}if(n.date&&!E(a)){d(o,"Please enter a valid date (YYYY-MM-DD)"),i=!1;continue}if(n.notFuture&&!U(a)){d(o,"Date cannot be in the future"),i=!1;continue}if(n.notPast&&!K(a)){d(o,"Date cannot be in the past"),i=!1;continue}}}return i}function Q(){const e=document.querySelector('meta[name="csrf-token"]');return e?e.getAttribute("content"):null}const C={headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},timeout:3e4};function O(e={}){const t=Q(),i={...C.headers,...e.headers||{}};return t&&(i["X-CSRF-TOKEN"]=t),{...C,...e,headers:i}}async function F(e){const t=e.headers.get("content-type"),i=t&&t.includes("application/json");let r;if(i?r=await e.json():r=await e.text(),!e.ok){const n=new Error(r.message||"An error occurred");throw n.status=e.status,n.data=r,n}return r}function z(e,t=!0){console.error("[API Error]",e);let i="An unexpected error occurred",r=null;return e.data?(i=e.data.message||i,r=e.data.errors?Object.values(e.data.errors).flat():null):e.message&&(i=e.message),t&&p(i,r),Promise.reject(e)}async function Z(e,t={},i={}){try{const r=await fetch(e,O({method:"POST",body:JSON.stringify(t),...i}));return await F(r)}catch(r){return z(r,i.showError!==!1)}}async function ee(e,t={},i={}){try{const r=await fetch(e,O({method:"PUT",body:JSON.stringify(t),...i}));return await F(r)}catch(r){return z(r,i.showError!==!1)}}function c(e,t=document){return t.querySelector(e)}function v(e,t,i,r){const n=typeof e=="string"?c(e):e;n&&(typeof i=="function"?n.addEventListener(t,i):n.addEventListener(t,o=>{const a=o.target.closest(i);a&&r.call(a,o)}))}function te(e,t=null){const i=typeof e=="string"?c(e):e;i&&(i.disabled=!0,i.classList.add("opacity-50","cursor-not-allowed"),t&&i.tagName==="BUTTON"&&(i.setAttribute("data-original-text",i.innerHTML),i.innerHTML=`<i class="fas fa-spinner fa-spin mr-2"></i>${t}`))}function ie(e){const t=typeof e=="string"?c(e):e;t&&(t.disabled=!1,t.classList.remove("opacity-50","cursor-not-allowed"),t.hasAttribute("data-original-text")&&(t.innerHTML=t.getAttribute("data-original-text"),t.removeAttribute("data-original-text")))}function re(e){const t=typeof e=="string"?c(e):e;if(!t)return{};const i=new FormData(t),r={};for(const[n,o]of i.entries())r[n]?Array.isArray(r[n])?r[n].push(o):r[n]=[r[n],o]:r[n]=o;return r}function S(e){const t=typeof e=="string"?c(e):e;if(!t)return;t.reset(),t.querySelectorAll('[data-validation-error="true"]').forEach(n=>n.remove()),t.querySelectorAll("input, select, textarea").forEach(n=>{n.classList.remove("border-red-500","focus:border-red-500","focus:ring-red-500"),n.classList.add("border-gray-300")})}function ne(e,t=0){const i=typeof e=="string"?c(e):e;if(!i)return;const r=()=>{const n=i.querySelector('input:not([type="hidden"]):not([disabled]), select:not([disabled]), textarea:not([disabled])');n&&n.focus()};t>0?setTimeout(r,t):r()}function u(e,t={},i=null){const r=document.createElement(e);for(const[n,o]of Object.entries(t))n==="class"?r.className=o:n==="dataset"?Object.assign(r.dataset,o):r.setAttribute(n,o);return i!==null&&(Array.isArray(i)?i.forEach(n=>{typeof n=="string"?r.appendChild(document.createTextNode(n)):r.appendChild(n)}):typeof i=="string"?r.textContent=i:i instanceof Element&&r.appendChild(i)),r}const L={bhw:{dashboard:"/bhw/dashboard",patients:{index:"/bhw/patients",create:"/bhw/patients/create",store:"/bhw/patients",show:e=>`/bhw/patients/${e}`,edit:e=>`/bhw/patients/${e}/edit`,update:e=>`/bhw/patients/${e}`,destroy:e=>`/bhw/patients/${e}`},prenatalRecords:{index:"/bhw/prenatalrecords",create:"/bhw/prenatalrecords/create",store:"/bhw/prenatalrecords",show:e=>`/bhw/prenatalrecords/${e}`,edit:e=>`/bhw/prenatalrecords/${e}/edit`,update:e=>`/bhw/prenatalrecords/${e}`,destroy:e=>`/bhw/prenatalrecords/${e}`},prenatalCheckups:{index:"/bhw/prenatalcheckups",create:"/bhw/prenatalcheckups/create",store:"/bhw/prenatalcheckups",show:e=>`/bhw/prenatalcheckups/${e}`,edit:e=>`/bhw/prenatalcheckups/${e}/edit`,update:e=>`/bhw/prenatalcheckups/${e}`,destroy:e=>`/bhw/prenatalcheckups/${e}`},childRecords:{index:"/bhw/childrecords",create:"/bhw/childrecords/create",store:"/bhw/childrecords",show:e=>`/bhw/childrecords/${e}`,edit:e=>`/bhw/childrecords/${e}/edit`,update:e=>`/bhw/childrecords/${e}`,destroy:e=>`/bhw/childrecords/${e}`},immunizations:{index:"/bhw/immunizations",create:"/bhw/immunizations/create",store:"/bhw/immunizations",show:e=>`/bhw/immunizations/${e}`,edit:e=>`/bhw/immunizations/${e}/edit`,update:e=>`/bhw/immunizations/${e}`,destroy:e=>`/bhw/immunizations/${e}`,reschedule:e=>`/bhw/immunizations/${e}/reschedule`},appointments:{index:"/bhw/appointments",create:"/bhw/appointments/create",store:"/bhw/appointments",show:e=>`/bhw/appointments/${e}`,update:e=>`/bhw/appointments/${e}`,destroy:e=>`/bhw/appointments/${e}`},reports:{index:"/bhw/reports",generate:"/bhw/reports/generate",export:"/bhw/reports/export"}},midwife:{dashboard:"/midwife/dashboard",patients:{index:"/midwife/patients",create:"/midwife/patients/create",store:"/midwife/patients",show:e=>`/midwife/patients/${e}`,edit:e=>`/midwife/patients/${e}/edit`,update:e=>`/midwife/patients/${e}`,destroy:e=>`/midwife/patients/${e}`},prenatalRecords:{index:"/midwife/prenatalrecords",create:"/midwife/prenatalrecords/create",store:"/midwife/prenatalrecords",show:e=>`/midwife/prenatalrecords/${e}`,edit:e=>`/midwife/prenatalrecords/${e}/edit`,update:e=>`/midwife/prenatalrecords/${e}`,destroy:e=>`/midwife/prenatalrecords/${e}`},prenatalCheckups:{index:"/midwife/prenatalcheckups",create:"/midwife/prenatalcheckups/create",store:"/midwife/prenatalcheckups",show:e=>`/midwife/prenatalcheckups/${e}`,edit:e=>`/midwife/prenatalcheckups/${e}/edit`,update:e=>`/midwife/prenatalcheckups/${e}`,destroy:e=>`/midwife/prenatalcheckups/${e}`},childRecords:{index:"/midwife/childrecords",create:"/midwife/childrecords/create",store:"/midwife/childrecords",show:e=>`/midwife/childrecords/${e}`,edit:e=>`/midwife/childrecords/${e}/edit`,update:e=>`/midwife/childrecords/${e}`,destroy:e=>`/midwife/childrecords/${e}`},immunizations:{index:"/midwife/immunizations",create:"/midwife/immunizations/create",store:"/midwife/immunizations",show:e=>`/midwife/immunizations/${e}`,edit:e=>`/midwife/immunizations/${e}/edit`,update:e=>`/midwife/immunizations/${e}`,destroy:e=>`/midwife/immunizations/${e}`,reschedule:e=>`/midwife/immunizations/${e}/reschedule`},appointments:{index:"/midwife/appointments",create:"/midwife/appointments/create",store:"/midwife/appointments",show:e=>`/midwife/appointments/${e}`,update:e=>`/midwife/appointments/${e}`,destroy:e=>`/midwife/appointments/${e}`},vaccines:{index:"/midwife/vaccines",create:"/midwife/vaccines/create",store:"/midwife/vaccines",show:e=>`/midwife/vaccines/${e}`,edit:e=>`/midwife/vaccines/${e}/edit`,update:e=>`/midwife/vaccines/${e}`,destroy:e=>`/midwife/vaccines/${e}`,stock:"/midwife/vaccines/stock"},reports:{index:"/midwife/reports",generate:"/midwife/reports/generate",export:"/midwife/reports/export"},cloudBackup:{index:"/midwife/cloudbackup",backup:"/midwife/cloudbackup/backup",restore:"/midwife/cloudbackup/restore",download:e=>`/midwife/cloudbackup/${e}/download`,delete:e=>`/midwife/cloudbackup/${e}`}},admin:{dashboard:"/admin/dashboard",users:{index:"/admin/users",create:"/admin/users/create",store:"/admin/users",show:e=>`/admin/users/${e}`,edit:e=>`/admin/users/${e}/edit`,update:e=>`/admin/users/${e}`,destroy:e=>`/admin/users/${e}`,activate:e=>`/admin/users/${e}/activate`,deactivate:e=>`/admin/users/${e}/deactivate`},reports:{index:"/admin/reports",analytics:"/admin/reports/analytics",export:"/admin/reports/export"},settings:{index:"/admin/settings",update:"/admin/settings"}}};function oe(e){return L[e]?L[e]:(console.warn(`[Routes] Role "${e}" not found in routes configuration`),{})}function se(){if(window.userRole)return window.userRole;const e=document.querySelector('meta[name="user-role"]');if(e)return e.getAttribute("content");const t=window.location.pathname;return t.startsWith("/bhw")?"bhw":t.startsWith("/midwife")?"midwife":t.startsWith("/admin")?"admin":(console.warn("[Routes] Unable to determine current user role"),null)}function ae(){const e=se();return oe(e)}const $={bhw:{patients:{view:!0,create:!0,edit:!0,delete:!1,export:!1},prenatalRecords:{view:!0,create:!0,edit:!0,delete:!1,export:!1},prenatalCheckups:{view:!0,create:!0,edit:!0,delete:!1,export:!1},childRecords:{view:!0,create:!0,edit:!0,delete:!1,export:!1},immunizations:{view:!0,create:!0,edit:!0,delete:!1,reschedule:!0,export:!1},appointments:{view:!0,create:!0,edit:!0,delete:!1,export:!1},vaccines:{view:!1,create:!1,edit:!1,delete:!1,manageStock:!1},reports:{view:!0,generate:!0,export:!1},users:{view:!1,create:!1,edit:!1,delete:!1,manage:!1},cloudBackup:{view:!1,create:!1,restore:!1,delete:!1}},midwife:{patients:{view:!0,create:!0,edit:!0,delete:!0,export:!0},prenatalRecords:{view:!0,create:!0,edit:!0,delete:!0,export:!0},prenatalCheckups:{view:!0,create:!0,edit:!0,delete:!0,export:!0},childRecords:{view:!0,create:!0,edit:!0,delete:!0,export:!0},immunizations:{view:!0,create:!0,edit:!0,delete:!0,reschedule:!0,export:!0},appointments:{view:!0,create:!0,edit:!0,delete:!0,export:!0},vaccines:{view:!0,create:!0,edit:!0,delete:!0,manageStock:!0},reports:{view:!0,generate:!0,export:!0},users:{view:!1,create:!1,edit:!1,delete:!1,manage:!1},cloudBackup:{view:!0,create:!0,restore:!0,delete:!0}},admin:{patients:{view:!0,create:!0,edit:!0,delete:!0,export:!0},prenatalRecords:{view:!0,create:!0,edit:!0,delete:!0,export:!0},prenatalCheckups:{view:!0,create:!0,edit:!0,delete:!0,export:!0},childRecords:{view:!0,create:!0,edit:!0,delete:!0,export:!0},immunizations:{view:!0,create:!0,edit:!0,delete:!0,reschedule:!0,export:!0},appointments:{view:!0,create:!0,edit:!0,delete:!0,export:!0},vaccines:{view:!0,create:!0,edit:!0,delete:!0,manageStock:!0},reports:{view:!0,generate:!0,export:!0},users:{view:!0,create:!0,edit:!0,delete:!0,manage:!0},cloudBackup:{view:!0,create:!0,restore:!0,delete:!0},settings:{view:!0,edit:!0}}};function ce(e,t,i){return $[e]?$[e][t]?$[e][t][i]===!0:(console.warn(`[Permissions] Resource "${t}" not found for role "${e}"`),!1):(console.warn(`[Permissions] Role "${e}" not found`),!1)}function le(){if(window.userRole)return window.userRole;const e=document.querySelector('meta[name="user-role"]');if(e)return e.getAttribute("content");const t=window.location.pathname;return t.startsWith("/bhw")?"bhw":t.startsWith("/midwife")?"midwife":t.startsWith("/admin")?"admin":(console.warn("[Permissions] Unable to determine current user role"),null)}function M(e,t){const i=le();return ce(i,e,t)}class de{constructor(t,i={}){if(this.modal=typeof t=="string"?c(t):t,!this.modal){console.error("[Modal] Modal element not found:",t);return}this.options={closeOnEscape:!0,closeOnBackdrop:!0,onOpen:null,onClose:null,focusDelay:300,...i},this.isOpen=!1,this.form=this.modal.querySelector("form"),this.initialize()}initialize(){this.modal.querySelectorAll("[data-modal-close]").forEach(i=>{i.addEventListener("click",r=>{r.preventDefault(),this.close()})}),this.options.closeOnBackdrop&&this.modal.addEventListener("click",i=>{i.target===this.modal&&this.close()}),this.options.closeOnEscape&&document.addEventListener("keydown",i=>{i.key==="Escape"&&this.isOpen&&this.close()})}open(t=null){this.isOpen||(this.form&&S(this.form),t&&this.form&&this.populateForm(t),this.modal.classList.remove("hidden"),requestAnimationFrame(()=>{this.modal.classList.add("show")}),document.body.style.overflow="hidden",this.form&&ne(this.form,this.options.focusDelay),this.isOpen=!0,this.options.onOpen&&typeof this.options.onOpen=="function"&&this.options.onOpen(this))}close(){this.isOpen&&(this.modal.classList.remove("show"),setTimeout(()=>{this.modal.classList.add("hidden")},300),document.body.style.overflow="",this.isOpen=!1,this.options.onClose&&typeof this.options.onClose=="function"&&this.options.onClose(this))}toggle(){this.isOpen?this.close():this.open()}populateForm(t){if(this.form)for(const[i,r]of Object.entries(t)){const n=this.form.querySelector(`[name="${i}"]`);if(n)if(n.type==="checkbox")n.checked=r;else if(n.type==="radio"){const o=this.form.querySelector(`[name="${i}"][value="${r}"]`);o&&(o.checked=!0)}else n.value=r||""}}getFormData(){if(!this.form)return{};const t=new FormData(this.form),i={};for(const[r,n]of t.entries())i[r]?Array.isArray(i[r])?i[r].push(n):i[r]=[i[r],n]:i[r]=n;return i}reset(){this.form&&S(this.form)}}class ue{constructor(){this.modals=new Map}register(t,i,r={}){const n=new de(i,r);return this.modals.set(t,n),n}get(t){return this.modals.get(t)||null}open(t,i=null){const r=this.get(t);r?r.open(i):console.warn(`[ModalManager] Modal "${t}" not found`)}close(t){const i=this.get(t);i&&i.close()}closeAll(){this.modals.forEach(t=>t.close())}}const m={duration:3e3,position:"top-right",maxNotifications:5,animationDuration:300};let g=null;const h=[];function fe(){return g||(g=u("div",{id:"notification-container",class:`fixed ${me(m.position)} z-50 pointer-events-none`,style:"max-width: 400px;"}),document.body.appendChild(g)),g}function me(e){const t={"top-right":"top-4 right-4","top-left":"top-4 left-4","bottom-right":"bottom-4 right-4","bottom-left":"bottom-4 left-4","top-center":"top-4 left-1/2 -translate-x-1/2","bottom-center":"bottom-4 left-1/2 -translate-x-1/2"};return t[e]||t["top-right"]}function pe(e,t,i=null){const r={success:{bg:"bg-green-50",border:"border-green-500",text:"text-green-800",icon:"fa-check-circle",iconColor:"text-green-500"},error:{bg:"bg-red-50",border:"border-red-500",text:"text-red-800",icon:"fa-times-circle",iconColor:"text-red-500"},warning:{bg:"bg-yellow-50",border:"border-yellow-500",text:"text-yellow-800",icon:"fa-exclamation-triangle",iconColor:"text-yellow-500"},info:{bg:"bg-blue-50",border:"border-blue-500",text:"text-blue-800",icon:"fa-info-circle",iconColor:"text-blue-500"}},n=r[e]||r.info,o=u("div",{class:`flex-shrink-0 ${n.iconColor}`},u("i",{class:`fas ${n.icon} text-xl`})),a=u("div",{class:"ml-3 flex-1"},[i?u("p",{class:"text-sm font-semibold"},i):null,u("p",{class:"text-sm"},t)].filter(Boolean)),l=u("button",{class:"ml-4 flex-shrink-0 inline-flex text-gray-400 hover:text-gray-500 focus:outline-none",type:"button"},u("i",{class:"fas fa-times"}));return{element:u("div",{class:`${n.bg} ${n.border} ${n.text} border-l-4 p-4 mb-4 rounded-lg shadow-lg pointer-events-auto transform transition-all duration-300 opacity-0 translate-x-full`,role:"alert"},[u("div",{class:"flex items-start"},[o,a,l])]),closeBtn:l}}function y(e,t,i=null,r=m.duration){const n=fe();if(h.length>=m.maxNotifications){const l=h.shift();P(l)}const{element:o,closeBtn:a}=pe(e,t,i);n.appendChild(o),h.push(o),requestAnimationFrame(()=>{o.classList.remove("opacity-0","translate-x-full"),o.classList.add("opacity-100","translate-x-0")}),a.addEventListener("click",()=>{P(o)}),r>0&&setTimeout(()=>{P(o)},r)}function P(e){!e||!e.parentNode||(e.classList.remove("opacity-100","translate-x-0"),e.classList.add("opacity-0","translate-x-full"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e);const t=h.indexOf(e);t>-1&&h.splice(t,1)},m.animationDuration))}function he(e,t="Success",i=m.duration){y("success",e,t,i)}function we(e,t="Error",i=m.duration){y("error",e,t,i)}function ge(e,t="Warning",i=m.duration){y("warning",e,t,i)}function be(e,t="Info",i=m.duration){y("info",e,t,i)}function ye(){const e=document.querySelector("[data-toast-success]"),t=document.querySelector("[data-toast-error]"),i=document.querySelector("[data-toast-warning]"),r=document.querySelector("[data-toast-info]");e&&he(e.getAttribute("data-toast-success")),t&&we(t.getAttribute("data-toast-error")),i&&ge(i.getAttribute("data-toast-warning")),r&&be(r.getAttribute("data-toast-info"))}document.addEventListener("DOMContentLoaded",ye);class xe{constructor(t,i={}){if(this.form=typeof t=="string"?document.querySelector(t):t,!this.form){console.error("[Form] Form element not found:",t);return}this.options={validation:{},onSuccess:null,onError:null,resetOnSuccess:!0,successMessage:"Form submitted successfully!",showSuccessAlert:!0,showErrorAlert:!0,...i},this.submitButton=null,this.isSubmitting=!1,this.initialize()}initialize(){this.submitButton=this.form.querySelector('[type="submit"]'),this.form.addEventListener("submit",i=>{i.preventDefault(),this.submit()}),this.form.querySelectorAll("input, select, textarea").forEach(i=>{i.addEventListener("input",()=>{N(this.form)})}),console.log("[Form] Initialized:",this.form.id||"form")}validate(){return Object.keys(this.options.validation).length===0?!0:G(this.form,this.options.validation)}getData(){return re(this.form)}setData(t){for(const[i,r]of Object.entries(t)){const n=this.form.querySelector(`[name="${i}"]`);if(n)if(n.type==="checkbox")n.checked=r;else if(n.type==="radio"){const o=this.form.querySelector(`[name="${i}"][value="${r}"]`);o&&(o.checked=!0)}else n.value=r||""}}reset(){S(this.form)}cleanPhoneNumbers(t){["contact","phone","emergency_contact","phone_number","mobile"].forEach(r=>{if(t[r]){let n=t[r].replace(/[\s-]/g,"");n.startsWith("+639")?n="0"+n.substring(3):n.startsWith("639")&&(n="0"+n.substring(2)),t[r]=n}})}disableForm(t="Submitting..."){this.form.querySelectorAll("input, select, textarea, button").forEach(r=>{r.disabled=!0}),this.submitButton&&te(this.submitButton,t),this.isSubmitting=!0}enableForm(){this.form.querySelectorAll("input, select, textarea, button").forEach(i=>{i.disabled=!1}),this.submitButton&&ie(this.submitButton),this.isSubmitting=!1}async submit(){if(!this.isSubmitting){if(!this.validate()){console.log("[Form] Validation failed");return}this.disableForm();try{const t=this.getData();this.cleanPhoneNumbers(t);const i=this.form.method?.toLowerCase()||"post",r=this.form.action;let n;i==="put"||i==="patch"?n=await ee(r,t,{showError:!1}):n=await Z(r,t,{showError:!1}),this.enableForm(),this.options.showSuccessAlert?b(n.message||this.options.successMessage,()=>{this.options.onSuccess&&this.options.onSuccess(n,this)}):this.options.onSuccess&&this.options.onSuccess(n,this),this.options.resetOnSuccess&&this.reset()}catch(t){this.enableForm();const i=t.data?.message||"An error occurred",r=t.data?.errors?Object.values(t.data.errors).flat():null;this.options.showErrorAlert&&p(i,r),this.options.onError&&this.options.onError(t,this)}}}}function q(e,t={}){return new xe(e,t)}let s={currentPatientData:null,modals:null,forms:null,routes:null};function ve(){console.log("[Patients] Initializing...");try{s.routes=ae(),console.log("[Patients] Routes loaded:",s.routes),$e(),console.log("[Patients] Modals initialized"),Pe(),console.log("[Patients] Forms initialized"),Se(),console.log("[Patients] Table actions initialized"),Ee(),console.log("[Patients] Search form initialized"),console.log("[Patients] Initialization complete")}catch(e){throw console.error("[Patients] Initialization failed:",e),e}}function $e(){console.log("[Patients] Initializing modals..."),s.modals=new ue,s.modals.register("add","#patient-modal",{onClose:()=>{const e=c("#patient-modal form");e&&e.reset()}}),s.modals.register("view","#view-patient-modal",{closeOnBackdrop:!0}),s.modals.register("edit","#edit-patient-modal",{onClose:()=>{const e=c("#edit-patient-modal form");e&&e.reset()}}),console.log("[Patients] Exposing global modal functions..."),window.openPatientModal=()=>s.modals.open("add"),window.closePatientModal=()=>s.modals.close("add"),window.openViewPatientModal=e=>T(e),window.closeViewPatientModal=()=>s.modals.close("view"),window.openEditPatientModal=e=>R(e),window.closeEditPatientModal=()=>s.modals.close("edit"),console.log("[Patients] Global functions exposed:",{openPatientModal:typeof window.openPatientModal,closePatientModal:typeof window.closePatientModal,openViewPatientModal:typeof window.openViewPatientModal,closeViewPatientModal:typeof window.closeViewPatientModal,openEditPatientModal:typeof window.openEditPatientModal,closeEditPatientModal:typeof window.closeEditPatientModal})}function Pe(){s.forms={};const e=c("#patient-modal form");e&&(s.forms.add=q(e,{validation:{first_name:{required:!0,minLength:2},last_name:{required:!0,minLength:2},age:{required:!0,min:15,max:50},occupation:{required:!0},contact:{required:!0,phone:!0},emergency_contact:{required:!0,phone:!0},address:{required:!0}},successMessage:"Patient added successfully!",onSuccess:i=>{s.modals.close("add"),window.location.reload()}}));const t=c("#edit-patient-modal form");t&&(s.forms.edit=q(t,{validation:{first_name:{required:!0,minLength:2},last_name:{required:!0,minLength:2},age:{required:!0,min:15,max:50},occupation:{required:!0},contact:{required:!0,phone:!0},emergency_contact:{required:!0,phone:!0},address:{required:!0}},successMessage:"Patient updated successfully!",onSuccess:i=>{s.modals.close("edit"),window.location.reload()}}))}function Se(){const e=c("#patientsTable tbody");e&&(v(e,"click",".btn-view-patient",function(t){t.preventDefault();const i=JSON.parse(this.getAttribute("data-patient"));T(i)}),M("patients","edit")&&v(e,"click",".btn-edit-patient",function(t){t.preventDefault();const i=JSON.parse(this.getAttribute("data-patient"));R(i)}),M("patients","delete")&&v(e,"click",".btn-delete-patient",function(t){t.preventDefault();const i=this.getAttribute("data-id"),r=this.getAttribute("data-name");Ae(i,r)}))}function Ee(){const e=c('form[role="search"]');if(!e)return;const t=e.querySelector('input[name="search"]');t&&t.addEventListener("keypress",i=>{i.key==="Enter"&&(i.preventDefault(),e.submit())})}function T(e){if(!e){console.error("[Patients] No patient data provided");return}s.currentPatientData=e,ke(e),s.modals.open("view")}function ke(e){f("#viewPatientName",e.name||`${e.first_name} ${e.last_name}`||"N/A"),f("#viewPatientId",e.formatted_patient_id||"N/A"),f("#viewPatientAge",e.age?`${e.age} years`:"N/A"),f("#viewPatientContact",e.contact||"N/A"),f("#viewPatientEmergencyContact",e.emergency_contact||"N/A"),f("#viewPatientAddress",e.address||"N/A"),f("#viewPatientOccupation",e.occupation||"N/A");const t=c("#viewPatientRiskStatus");if(t&&e.active_prenatal_record){const r=e.active_prenatal_record.status,n={normal:'<span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">Normal</span>',monitor:'<span class="px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full">Monitor</span>',"high-risk":'<span class="px-2 py-1 text-xs bg-red-100 text-red-800 rounded-full">High Risk</span>',due:'<span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">Due</span>'};t.innerHTML=n[r]||'<span class="text-gray-500">N/A</span>'}f("#viewPatientEDD",e.active_prenatal_record?.edd?new Date(e.active_prenatal_record.edd).toLocaleDateString():"N/A"),f("#viewPatientNotes",e.notes||"No notes available");const i=c("#viewPatientProfileBtn");i&&s.routes.patients&&e.id&&(i.href=s.routes.patients.show(e.id))}function R(e){if(!e){console.error("[Patients] No patient data provided");return}console.log("[Patients] Opening edit modal with data:",e),s.currentPatientData=e;const t=c("#edit-patient-modal form");if(t&&s.forms.edit){let i=e.first_name||"",r=e.last_name||"";if(!i&&!r&&e.name){const n=e.name.trim().split(" ");i=n[0]||"",r=n.slice(1).join(" ")||""}s.forms.edit.setData({first_name:i,last_name:r,middle_name:e.middle_name||"",age:e.age||"",birthdate:e.birthdate||"",contact:e.contact||"",emergency_contact:e.emergency_contact||"",address:e.address||"",occupation:e.occupation||"",notes:e.notes||""}),s.routes.patients&&e.id&&(t.action=s.routes.patients.update(e.id))}s.modals.open("edit")}function Ae(e,t){D(`Patient: ${t}`,()=>{const i=document.createElement("form");i.method="POST",i.action=s.routes.patients.destroy(e);const r=document.querySelector('meta[name="csrf-token"]');if(r){const o=document.createElement("input");o.type="hidden",o.name="_token",o.value=r.content,i.appendChild(o)}const n=document.createElement("input");n.type="hidden",n.name="_method",n.value="DELETE",i.appendChild(n),document.body.appendChild(i),i.submit()})}function f(e,t){const i=c(e);i&&(i.textContent=t)}document.addEventListener("DOMContentLoaded",ve);export{ue as M,q as a,M as c,ae as g,v as o,c as q,p as s};

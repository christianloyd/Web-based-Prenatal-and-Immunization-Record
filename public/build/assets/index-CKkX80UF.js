import{g as m,c as s,q as o,a as d,o as l,s as w,M as f}from"./patients-XK7a02o0.js";let a={currentRecord:null,modals:null,forms:null,routes:null};function g(){console.log("[PrenatalRecords] Initializing..."),a.routes=m(),v(),h(),P(),console.log("[PrenatalRecords] Initialization complete")}function v(){a.modals=new f,a.modals.register("view","#view-prenatal-modal"),a.modals.register("edit","#edit-prenatal-modal"),s("prenatalRecords","complete")&&a.modals.register("complete","#completePregnancyModal"),window.openViewPrenatalModal=e=>c(e),window.closeViewPrenatalModal=()=>a.modals.close("view"),window.openEditPrenatalModal=e=>p(e),window.closeEditPrenatalModal=()=>a.modals.close("edit"),window.openCompletePregnancyModal=(e,t)=>u(e,t),window.closeCompletePregnancyModal=()=>a.modals.close("complete")}function h(){a.forms={};const e=o("#edit-prenatal-form");e&&(a.forms.edit=d(e,{validation:{last_menstrual_period:{required:!0,date:!0,notFuture:!0},blood_pressure:{required:!1},weight:{numeric:!0},height:{numeric:!0}},successMessage:"Prenatal record updated successfully!",onSuccess:()=>{a.modals.close("edit"),window.location.reload()}}));const t=o("#completePregnancyForm");t&&s("prenatalRecords","complete")&&(a.forms.complete=d(t,{successMessage:"Pregnancy completed successfully!",onSuccess:()=>{a.modals.close("complete"),window.location.reload()}}))}function P(){const e=o("table tbody");e&&(l(e,"click",'.btn-view-prenatal, [onclick*="openViewPrenatalModal"]',function(t){if(this.dataset.record){t.preventDefault();const n=JSON.parse(this.dataset.record);c(n)}}),s("prenatalRecords","edit")&&l(e,"click",'.btn-edit-prenatal, [onclick*="openEditPrenatalModal"]',function(t){if(this.dataset.record){t.preventDefault();const n=JSON.parse(this.dataset.record);p(n)}}),s("prenatalRecords","complete")&&l(e,"click",".btn-complete-pregnancy",function(t){t.preventDefault();const n=this.dataset.id,i=this.dataset.name;u(n,i)}))}function c(e){if(!e){console.error("[PrenatalRecords] No record data provided");return}a.currentRecord=e;const t=(n,i)=>{const r=o(`#${n}`);r&&(r.textContent=i||"N/A")};t("viewPatientName",e.patient?.name),t("viewPatientId",e.patient?.formatted_patient_id),t("viewPatientAge",e.patient?.age?`${e.patient.age} years`:null),t("viewGestationalAge",e.gestational_age),t("viewTrimester",_(e.trimester)),t("viewLMP",e.last_menstrual_period),t("viewEDD",e.expected_due_date),t("viewGravida",e.gravida?`G${e.gravida}`:null),t("viewPara",e.para!==null?`P${e.para}`:null),t("viewStatus",e.status_text||e.status),t("viewBloodPressure",e.blood_pressure),t("viewWeight",e.weight?`${e.weight} kg`:null),t("viewHeight",e.height?`${e.height} cm`:null),t("viewMedicalHistory",e.medical_history),t("viewNotes",e.notes),t("viewLastVisit",e.last_visit),t("viewNextAppointment",e.next_appointment),a.modals.open("view")}function p(e){if(!e){console.error("[PrenatalRecords] No record data provided");return}a.currentRecord=e;const t=o("#edit-prenatal-form");t&&a.forms.edit&&(a.forms.edit.setData({last_menstrual_period:R(e.last_menstrual_period),gravida:e.gravida||"",para:e.para||"",blood_pressure:e.blood_pressure||"",weight:e.weight||"",height:e.height||"",medical_history:e.medical_history||"",notes:e.notes||""}),a.routes.prenatalRecords&&e.id&&(t.action=a.routes.prenatalRecords.update(e.id))),a.modals.open("edit")}function u(e,t){if(!s("prenatalRecords","complete")){w("You do not have permission to complete pregnancies");return}const n=o("#completePatientName");n&&(n.textContent=t||"Unknown Patient");const i=o("#completePregnancyForm");i&&a.routes.prenatalRecords&&(i.action=`${a.routes.prenatalRecords.show(e).replace(/\/\d+$/,"")}/${e}/complete`),a.modals.open("complete")}function _(e){if(!e)return"N/A";const t=e==1?"st":e==2?"nd":"rd";return`${e}${t} Trimester`}function R(e){if(!e)return"";try{return new Date(e).toISOString().split("T")[0]}catch{return""}}document.addEventListener("DOMContentLoaded",g);

import{b as r,g as v,M,q as l,a as x,o as w,c as h,d as N}from"./form-CTbhfyRB.js";const d={duration:3e3,position:"top-right",maxNotifications:5,animationDuration:300};let m=null;const u=[];function _(){return m||(m=r("div",{id:"notification-container",class:`fixed ${E(d.position)} z-50 pointer-events-none`,style:"max-width: 400px;"}),document.body.appendChild(m)),m}function E(t){const o={"top-right":"top-4 right-4","top-left":"top-4 left-4","bottom-right":"bottom-4 right-4","bottom-left":"bottom-4 left-4","top-center":"top-4 left-1/2 -translate-x-1/2","bottom-center":"bottom-4 left-1/2 -translate-x-1/2"};return o[t]||o["top-right"]}function q(t,o,e=null){const i={success:{bg:"bg-green-50",border:"border-green-500",text:"text-green-800",icon:"fa-check-circle",iconColor:"text-green-500"},error:{bg:"bg-red-50",border:"border-red-500",text:"text-red-800",icon:"fa-times-circle",iconColor:"text-red-500"},warning:{bg:"bg-yellow-50",border:"border-yellow-500",text:"text-yellow-800",icon:"fa-exclamation-triangle",iconColor:"text-yellow-500"},info:{bg:"bg-blue-50",border:"border-blue-500",text:"text-blue-800",icon:"fa-info-circle",iconColor:"text-blue-500"}},a=i[t]||i.info,s=r("div",{class:`flex-shrink-0 ${a.iconColor}`},r("i",{class:`fas ${a.icon} text-xl`})),g=r("div",{class:"ml-3 flex-1"},[e?r("p",{class:"text-sm font-semibold"},e):null,r("p",{class:"text-sm"},o)].filter(Boolean)),f=r("button",{class:"ml-4 flex-shrink-0 inline-flex text-gray-400 hover:text-gray-500 focus:outline-none",type:"button"},r("i",{class:"fas fa-times"}));return{element:r("div",{class:`${a.bg} ${a.border} ${a.text} border-l-4 p-4 mb-4 rounded-lg shadow-lg pointer-events-auto transform transition-all duration-300 opacity-0 translate-x-full`,role:"alert"},[r("div",{class:"flex items-start"},[s,g,f])]),closeBtn:f}}function p(t,o,e=null,i=d.duration){const a=_();if(u.length>=d.maxNotifications){const f=u.shift();b(f)}const{element:s,closeBtn:g}=q(t,o,e);a.appendChild(s),u.push(s),requestAnimationFrame(()=>{s.classList.remove("opacity-0","translate-x-full"),s.classList.add("opacity-100","translate-x-0")}),g.addEventListener("click",()=>{b(s)}),i>0&&setTimeout(()=>{b(s)},i)}function b(t){!t||!t.parentNode||(t.classList.remove("opacity-100","translate-x-0"),t.classList.add("opacity-0","translate-x-full"),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t);const o=u.indexOf(t);o>-1&&u.splice(o,1)},d.animationDuration))}function C(t,o="Success",e=d.duration){p("success",t,o,e)}function A(t,o="Error",e=d.duration){p("error",t,o,e)}function D(t,o="Warning",e=d.duration){p("warning",t,o,e)}function S(t,o="Info",e=d.duration){p("info",t,o,e)}function k(){const t=document.querySelector("[data-toast-success]"),o=document.querySelector("[data-toast-error]"),e=document.querySelector("[data-toast-warning]"),i=document.querySelector("[data-toast-info]");t&&C(t.getAttribute("data-toast-success")),o&&A(o.getAttribute("data-toast-error")),e&&D(e.getAttribute("data-toast-warning")),i&&S(i.getAttribute("data-toast-info"))}document.addEventListener("DOMContentLoaded",k);let n={currentPatientData:null,modals:null,forms:null,routes:null};function L(){console.log("[Patients] Initializing...");try{n.routes=v(),console.log("[Patients] Routes loaded:",n.routes),z(),console.log("[Patients] Modals initialized"),I(),console.log("[Patients] Forms initialized"),F(),console.log("[Patients] Table actions initialized"),T(),console.log("[Patients] Search form initialized"),console.log("[Patients] Initialization complete")}catch(t){throw console.error("[Patients] Initialization failed:",t),t}}function z(){console.log("[Patients] Initializing modals..."),n.modals=new M,n.modals.register("add","#patient-modal",{onClose:()=>{const t=l("#patient-modal form");t&&t.reset()}}),n.modals.register("view","#view-patient-modal",{closeOnBackdrop:!0}),n.modals.register("edit","#edit-patient-modal",{onClose:()=>{const t=l("#edit-patient-modal form");t&&t.reset()}}),console.log("[Patients] Exposing global modal functions..."),window.openPatientModal=()=>n.modals.open("add"),window.closePatientModal=()=>n.modals.close("add"),window.openViewPatientModal=t=>P(t),window.closeViewPatientModal=()=>n.modals.close("view"),window.openEditPatientModal=t=>y(t),window.closeEditPatientModal=()=>n.modals.close("edit"),console.log("[Patients] Global functions exposed:",{openPatientModal:typeof window.openPatientModal,closePatientModal:typeof window.closePatientModal,openViewPatientModal:typeof window.openViewPatientModal,closeViewPatientModal:typeof window.closeViewPatientModal,openEditPatientModal:typeof window.openEditPatientModal,closeEditPatientModal:typeof window.closeEditPatientModal})}function I(){n.forms={};const t=l("#patient-modal form");t&&(n.forms.add=x(t,{validation:{first_name:{required:!0,minLength:2},last_name:{required:!0,minLength:2},age:{required:!0,min:15,max:50},occupation:{required:!0},contact:{required:!0,phone:!0},emergency_contact:{required:!0,phone:!0},address:{required:!0}},successMessage:"Patient added successfully!",onSuccess:e=>{n.modals.close("add"),window.location.reload()}}));const o=l("#edit-patient-modal form");o&&(n.forms.edit=x(o,{validation:{first_name:{required:!0,minLength:2},last_name:{required:!0,minLength:2},age:{required:!0,min:15,max:50},occupation:{required:!0},contact:{required:!0,phone:!0},emergency_contact:{required:!0,phone:!0},address:{required:!0}},successMessage:"Patient updated successfully!",onSuccess:e=>{n.modals.close("edit"),window.location.reload()}}))}function F(){const t=l("#patientsTable tbody");t&&(w(t,"click",".btn-view-patient",function(o){o.preventDefault();const e=JSON.parse(this.getAttribute("data-patient"));P(e)}),h("patients","edit")&&w(t,"click",".btn-edit-patient",function(o){o.preventDefault();const e=JSON.parse(this.getAttribute("data-patient"));y(e)}),h("patients","delete")&&w(t,"click",".btn-delete-patient",function(o){o.preventDefault();const e=this.getAttribute("data-id"),i=this.getAttribute("data-name");O(e,i)}))}function T(){const t=l('form[role="search"]');if(!t)return;const o=t.querySelector('input[name="search"]');o&&o.addEventListener("keypress",e=>{e.key==="Enter"&&(e.preventDefault(),t.submit())})}function P(t){if(!t){console.error("[Patients] No patient data provided");return}n.currentPatientData=t,$(t),n.modals.open("view")}function $(t){c("#viewPatientName",t.name||`${t.first_name} ${t.last_name}`||"N/A"),c("#viewPatientId",t.formatted_patient_id||"N/A"),c("#viewPatientAge",t.age?`${t.age} years`:"N/A"),c("#viewPatientContact",t.contact||"N/A"),c("#viewPatientEmergencyContact",t.emergency_contact||"N/A"),c("#viewPatientAddress",t.address||"N/A"),c("#viewPatientOccupation",t.occupation||"N/A");const o=l("#viewPatientRiskStatus");if(o&&t.active_prenatal_record){const i=t.active_prenatal_record.status,a={normal:'<span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">Normal</span>',monitor:'<span class="px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full">Monitor</span>',"high-risk":'<span class="px-2 py-1 text-xs bg-red-100 text-red-800 rounded-full">High Risk</span>',due:'<span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">Due</span>'};o.innerHTML=a[i]||'<span class="text-gray-500">N/A</span>'}c("#viewPatientEDD",t.active_prenatal_record?.edd?new Date(t.active_prenatal_record.edd).toLocaleDateString():"N/A"),c("#viewPatientNotes",t.notes||"No notes available");const e=l("#viewPatientProfileBtn");e&&n.routes.patients&&t.id&&(e.href=n.routes.patients.show(t.id))}function y(t){if(!t){console.error("[Patients] No patient data provided");return}console.log("[Patients] Opening edit modal with data:",t),n.currentPatientData=t;const o=l("#edit-patient-modal form");if(o&&n.forms.edit){let e=t.first_name||"",i=t.last_name||"";if(!e&&!i&&t.name){const a=t.name.trim().split(" ");e=a[0]||"",i=a.slice(1).join(" ")||""}n.forms.edit.setData({first_name:e,last_name:i,middle_name:t.middle_name||"",age:t.age||"",birthdate:t.birthdate||"",contact:t.contact||"",emergency_contact:t.emergency_contact||"",address:t.address||"",occupation:t.occupation||"",notes:t.notes||""}),n.routes.patients&&t.id&&(o.action=n.routes.patients.update(t.id))}n.modals.open("edit")}function O(t,o){N(`Patient: ${o}`,()=>{const e=document.createElement("form");e.method="POST",e.action=n.routes.patients.destroy(t);const i=document.querySelector('meta[name="csrf-token"]');if(i){const s=document.createElement("input");s.type="hidden",s.name="_token",s.value=i.content,e.appendChild(s)}const a=document.createElement("input");a.type="hidden",a.name="_method",a.value="DELETE",e.appendChild(a),document.body.appendChild(e),e.submit()})}function c(t,o){const e=l(t);e&&(e.textContent=o)}document.addEventListener("DOMContentLoaded",L);
